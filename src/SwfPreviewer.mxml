<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					   xmlns:s="library://ns.adobe.com/flex/spark" 
					   xmlns:mx="library://ns.adobe.com/flex/mx"
					   width="1024"
					   height="768"
					   applicationComplete="_handleAppComplete(event)">
	
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import mx.controls.SWFLoader;
			import mx.events.FlexEvent;
			import mx.flash.UIMovieClip;
			
			//--------------------------------------------------------------------------
			//
			//  Properties
			//
			//--------------------------------------------------------------------------
			
			//----------------------------------
			//  Private:
			//----------------------------------
			
			private var curFile:String;
			private var curY:Number;
			private var fileSystem:File;
			private var files:Vector.<File>;
			private var swfLoaders:Vector.<SWFLoader>;
			
			//--------------------------------------------------------------------------
			//
			//  Methods
			//
			//--------------------------------------------------------------------------
			
			//----------------------------------
			//  Private:
			//----------------------------------
			
			private function _handleAppComplete(event:FlexEvent):void
			{
				_init();
			}
			
			private function _init():void
			{
				curY = 0;
				
				createFileSystem();
			}
			
			private function createFileSystem():void
			{
				fileSystem = new File();
				fileSystem.addEventListener(Event.SELECT, handleSelect, false, 0, true);
			}
			
			private function handleClick(event:MouseEvent):void
			{
				fileSystem.browseForDirectory("Select the folder that contains the swf files that you want to preview.");
			}
			
			private function handleComplete(event:Event):void
			{
				trace("handleComplete");
				var swfMovieClip:UIMovieClip = new UIMovieClip();
				swfMovieClip.addChild(event.currentTarget.content);
				swfContainer.addElement(swfMovieClip);
				swfMovieClip.y = curY;
				curY += swfMovieClip.height;
				//swfScrollPane.
			}
			
			private function handleSelect(event:Event):void
			{
				if(fileSystem.isDirectory)
				{
					files = new Vector.<File>();
					var fileArray:Array = fileSystem.getDirectoryListing();
					var fileUrl:String;
					var len:uint = fileArray.length;
					for(var i:int=0; i<len; i++) 
					{
						fileUrl = fileArray[i].nativePath as String;
						if(fileUrl.indexOf(".swf") > -1)
						{
							files.push(fileArray[i]);
						}
					}
					loadSwfs();
				}
			}
			
			private function loadSwfs():void
			{
				swfLoaders =  new Vector.<SWFLoader>();
				var curLoader:SWFLoader;
				var len:uint = files.length;
				len = 10;
				for(var i:int=0; i<len; i++) 
				{
					curLoader = new SWFLoader();
					curLoader.addEventListener(Event.COMPLETE, handleComplete);
					swfLoaders.push(curLoader);
					curLoader.load(files[i].nativePath);
				}
			}
			
		]]>
	</fx:Script>
	
	<s:VGroup width="100%" height="100%">
		<s:HGroup>
			<s:Button id="browseBtn" label="Browse" click="handleClick(event)"/>
		</s:HGroup>
		<s:Scroller id="swfScrollPane" width="100%" height="100%">
			<s:Group id="swfContainer" width="100%" height="100%">
				
			</s:Group>
		</s:Scroller>
	</s:VGroup>
	
</s:WindowedApplication>
